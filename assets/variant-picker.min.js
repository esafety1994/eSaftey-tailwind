class VariantPicker extends HTMLElement{constructor(){super()}get sectionId(){return this.dataset.sectionId}connectedCallback(){this.variantSelector=this.querySelectorAll('input[type="radio"], select'),this.handleChange=this.onVariantChange.bind(this);try{this.variants=this.dataset.variants?JSON.parse(this.dataset.variants):[]}catch(e){this.variants=[]}this.variantSelector.forEach(e=>{e.addEventListener("change",this.handleChange)}),this.querySelectorAll('input[type="radio"]').forEach(e=>{e.addEventListener("change",function(){updateActiveOptionStyles()})});try{updateSelectedOptionNames(this)}catch(e){}this.variantSelector.forEach(e=>{e.addEventListener("change",()=>{try{updateSelectedOptionNames(this)}catch(e){}})})}disconnectedCallback(){this.variantSelector.forEach(e=>{e.removeEventListener("change",this.handleChange)})}onVariantChange(e){let t=e.currentTarget.value;try{const e=this.querySelectorAll(".variant-picker__option"),n=Array.from(e).map(e=>{const t=e.querySelector("select");if(t)return(t.options[t.selectedIndex]?.text||"").trim();const n=e.querySelector('input[type="radio"]:checked')||e.querySelector('input[type="radio"]');if(n){const e=document.querySelector('label[for="'+n.id+'"]');return e?e.textContent.trim():(n.value||"").trim()}return""});if(this.variants&&this.variants.length&&n.length){const e=this.variants.find(e=>{const t=e.options||[e.option1,e.option2,e.option3].filter(Boolean);if(!t||!t.length)return!1;for(let e=0;e<n.length;e++){if((n[e]||"").toString().trim().toLowerCase()!==(t[e]||"").toString().trim().toLowerCase())return!1}return!0});e&&e.id&&(t=String(e.id))}}catch(e){}try{document.dispatchEvent(new CustomEvent("product:variant:changing",{detail:{variantId:t}}))}catch(e){}const n=`${window.location.pathname}?variant=${t}&section_id=${this.sectionId}`,r=document.querySelector(".product-container");if(r&&(r.classList.add("is-loading"),!r.querySelector(".product-loading-overlay"))){const e=document.createElement("div");e.className="product-loading-overlay",e.innerHTML='<div class="spinner"></div>',r.appendChild(e)}fetch(n).then(e=>e.text()).then(e=>{const t=document.createElement("div");t.innerHTML=e;const o=t.querySelector(".product-container");try{const e=t.querySelector("#esProductGlide"),n=document.getElementById("esProductGlide");if(e&&n){var c=e.getAttribute("data-start-index");null!==c&&n.setAttribute("data-start-index",c),n.innerHTML=e.innerHTML;var i=t.querySelector("#esProductThumbs"),a=document.getElementById("esProductThumbs");i&&a&&(a.innerHTML=i.innerHTML);try{document.dispatchEvent(new CustomEvent("product:content:replaced",{detail:{root:n}}))}catch(e){}}const r=t.querySelector("#product-price"),o=document.getElementById("product-price");r&&o&&(o.innerHTML=r.innerHTML);const d=t.querySelector("#product-sku"),s=document.getElementById("product-sku");d&&s&&(s.innerHTML=d.innerHTML);const l=t.querySelector("#product-stock-badge"),u=document.getElementById("product-stock-badge");l&&u&&(u.innerHTML=l.innerHTML);const p=t.querySelector("#product-backorder-text"),h=document.getElementById("product-backorder-text");p&&h&&(h.innerHTML=p.innerHTML);const m=t.querySelector("#product-act-button"),y=document.getElementById("product-act-button");m&&y&&(y.innerHTML=m.innerHTML);const v=t.querySelector("[data-sticky-cart]"),S=document.querySelector("[data-sticky-cart]");v&&S&&(S.innerHTML=v.innerHTML);const g=t.querySelector('form input[name="id"]'),f=document.querySelector('form input[name="id"]');g&&f&&(f.value=g.value)}catch(e){console.warn("VariantPicker: selective update failed",e)}try{document.dispatchEvent(new CustomEvent("product:content:replaced",{detail:{root:o||r}}))}catch(e){}setTimeout(function(){if(r){r.classList.remove("is-loading");const e=r.querySelector(".product-loading-overlay");e&&e.parentNode.removeChild(e)}},120);const d=new URL(n,window.location.origin);d.searchParams.delete("section_id"),window.history.pushState({},"",d.toString())}).catch(e=>{if(console.error("Error fetching variant data:",e),r){r.classList.remove("is-loading");const e=r.querySelector(".product-loading-overlay");e&&e.parentNode.removeChild(e)}}),console.log("Selected Variant ID:",n)}}function updateActiveOptionStyles(){try{document.querySelectorAll('.product-container input[type="radio"]').forEach(function(e){var t=document.querySelector('label[for="'+e.id+'"]');t&&(e.checked?(t.classList.add("swatch-active"),t.classList.add("scale-110"),t.classList.add("shadow-lg")):(t.classList.remove("swatch-active"),t.classList.remove("scale-110"),t.classList.remove("shadow-lg")))})}catch(e){}}function updateSelectedOptionNames(e){const t=e||document;try{t.querySelectorAll(".variant-picker__option").forEach(function(e){const t=e.querySelector("legend"),n=e.querySelector(".variant-selected-name");if(!n||!t)return;const r=(t.textContent||"").trim().toLowerCase();if(-1===r.indexOf("size")&&-1===r.indexOf("colour")&&-1===r.indexOf("color"))return void(n.textContent="");const o=e.querySelector("select");if(o){const e=o.options[o.selectedIndex];return void(n.textContent=e?e.text.trim():"")}const c=e.querySelector('input[type="radio"]');if(!c)return void(n.textContent="");const i=c.getAttribute("name"),a=e.querySelector('input[name="'+i+'"]:checked')||document.querySelector('input[name="'+i+'"]:checked');if(a){const e=document.querySelector('label[for="'+a.id+'"]');n.textContent=e?e.textContent.trim():a.value||""}else n.textContent=""})}catch(e){}}customElements.define("variant-picker",VariantPicker),document.addEventListener("DOMContentLoaded",updateActiveOptionStyles),document.addEventListener("product:content:replaced",updateActiveOptionStyles),document.addEventListener("DOMContentLoaded",function(){updateSelectedOptionNames(document)}),document.addEventListener("product:content:replaced",function(){updateSelectedOptionNames(document)});