class EsafetyDrawer extends HTMLElement{constructor(){super(),this.openTrigger=document.querySelector("[data-drawer-trigger]"),this.overlay=this.querySelector("#cart-overlay")||this.querySelector("#drawer-overlay"),this.panel=this.querySelector("#cart-drawer")||this.querySelector(".esafety-drawer-panel"),this.closeButton=this.querySelector("[data-drawer-close]"),this.cartCount=document.querySelector(".cart-count")}connectedCallback(){this.openTrigger&&this.openTrigger.addEventListener("click",this.handleOpen.bind(this)),this.closeButton&&this.closeButton.addEventListener("click",this.handleClose.bind(this)),this.panel||(this.panel=this.querySelector("#cart-drawer")),this.overlay||(this.overlay=this.querySelector("#cart-overlay")),document.addEventListener("click",e=>{e.target===this.overlay&&this.closeDrawer()}),document.addEventListener("cart:render",this.cartRender.bind(this))}handleOpen(e){e.preventDefault(),this.openDrawer()}handleClose(e){e&&"function"==typeof e.preventDefault&&e.preventDefault(),this.closeDrawer()}openDrawer(){this.overlay&&this.overlay.classList.remove("hidden"),this.panel?(this.panel.classList.remove("translate-x-full","-translate-x-full"),this.panel.classList.add("translate-x-0"),this.panel.setAttribute("aria-hidden","false"),this.setAttribute("open","")):this.setAttribute("open","");try{this._previousBodyOverflow=document.body.style.overflow,document.body.style.overflow="hidden"}catch(e){}}closeDrawer(){if(this.panel){this.overlay&&this.overlay.classList.add("hidden");try{document.body.style.overflow=this._previousBodyOverflow||""}catch(e){}this.panel.classList.contains("left")||this.panel.classList.contains("-translate-x-full")?(this.panel.classList.remove("translate-x-0"),this.panel.offsetWidth,this.panel.classList.add("-translate-x-full")):(this.panel.classList.remove("translate-x-0"),this.panel.offsetWidth,this.panel.classList.add("translate-x-full"));var e=t=>{t.propertyName&&-1===t.propertyName.indexOf("transform")||this.panel.removeEventListener("transitionend",e)};this.panel.addEventListener("transitionend",e),this.panel.setAttribute("aria-hidden","true")}else{this.overlay&&this.overlay.classList.add("hidden");try{document.body.style.overflow=this._previousBodyOverflow||""}catch(e){}}this.removeAttribute("open")}cartRender(e){const t=document.querySelector("[data-item-count-drawer]"),r=document.querySelector("[data-cart-total-drawer]"),s=document.createElement("div"),a=document.createElement("div"),n=e.detail.sections["esaftey-cart-drawer"],i=e.detail.sections["cart-count"];s.innerHTML=n,a.innerHTML=i,this.querySelector("#cart-drawer-content").innerHTML=s.querySelector("#cart-drawer-content").innerHTML;const l=a.querySelector(".cart-count");if(l){this.cartCount.innerHTML=l.innerHTML;const e=(l.textContent||l.innerText||"").trim(),r=e.replace(/[^0-9]/g,"");t&&(t.innerHTML=""!==r?r:e)}const o=s.querySelector("#cart-total");o&&(r.innerHTML=o.innerHTML),this.openDrawer()}disconnectedCallback(){}}customElements.define("esafety-drawer",EsafetyDrawer);