class EsafetyDrawer extends HTMLElement{constructor(){super(),this.openTrigger=document.querySelector("[data-drawer-trigger]"),this.overlay=this.querySelector("#cart-overlay")||this.querySelector("#drawer-overlay"),this.panel=this.querySelector("#cart-drawer")||this.querySelector(".esafety-drawer-panel"),this.closeButton=this.querySelector("[data-drawer-close]"),this.cartCount=document.querySelector(".cart-count"),this._isScrollLocked=!1}connectedCallback(){this.openTrigger&&this.openTrigger.addEventListener("click",this.handleOpen.bind(this)),this.closeButton&&this.closeButton.addEventListener("click",this.handleClose.bind(this)),this.panel||(this.panel=this.querySelector("#cart-drawer")),this.overlay||(this.overlay=this.querySelector("#cart-overlay")),document.addEventListener("click",e=>{e.target===this.overlay&&this.closeDrawer()}),document.addEventListener("cart:render",this.cartRender.bind(this))}handleOpen(e){e.preventDefault(),this.openDrawer()}handleClose(e){e&&"function"==typeof e.preventDefault&&e.preventDefault(),this.closeDrawer()}openDrawer(){this.overlay&&this.overlay.classList.remove("hidden"),this.panel?(this.panel.classList.remove("translate-x-full","-translate-x-full"),this.panel.classList.add("translate-x-0"),this.panel.setAttribute("aria-hidden","false"),this.setAttribute("open","")):this.setAttribute("open","");try{this._isScrollLocked||(this._previousBodyOverflow=document.body.style.overflow,this._previousHtmlOverflow=document.documentElement.style.overflow,document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",this._isScrollLocked=!0)}catch(e){}}closeDrawer(){if(this.panel){this.overlay&&this.overlay.classList.add("hidden");try{this._isScrollLocked&&(document.body.style.overflow=this._previousBodyOverflow||"",document.documentElement.style.overflow=this._previousHtmlOverflow||"",this._isScrollLocked=!1)}catch(e){}this.panel.classList.contains("left")||this.panel.classList.contains("-translate-x-full")?(this.panel.classList.remove("translate-x-0"),this.panel.offsetWidth,this.panel.classList.add("-translate-x-full")):(this.panel.classList.remove("translate-x-0"),this.panel.offsetWidth,this.panel.classList.add("translate-x-full"));var e=t=>{t.propertyName&&-1===t.propertyName.indexOf("transform")||this.panel.removeEventListener("transitionend",e)};this.panel.addEventListener("transitionend",e),this.panel.setAttribute("aria-hidden","true")}else{this.overlay&&this.overlay.classList.add("hidden");try{this._isScrollLocked&&(document.body.style.overflow=this._previousBodyOverflow||"",document.documentElement.style.overflow=this._previousHtmlOverflow||"",this._isScrollLocked=!1)}catch(e){}}this.removeAttribute("open")}cartRender(e){const t=document.querySelector("[data-item-count-drawer]"),r=document.querySelector("[data-cart-total-drawer]"),s=document.createElement("div"),n=document.createElement("div"),i=e.detail.sections["esaftey-cart-drawer"],o=e.detail.sections["cart-count"];s.innerHTML=i,n.innerHTML=o,this.querySelector("#cart-drawer-content").innerHTML=s.querySelector("#cart-drawer-content").innerHTML;const a=n.querySelector(".cart-count");if(a){this.cartCount.innerHTML=a.innerHTML;const e=(a.textContent||a.innerText||"").trim(),r=e.replace(/[^0-9]/g,"");t&&(t.innerHTML=""!==r?r:e)}const l=s.querySelector("#cart-total");l&&(r.innerHTML=l.innerHTML),this.openDrawer()}disconnectedCallback(){}}customElements.define("esafety-drawer",EsafetyDrawer);