!function(){function e(e){var t=e&&"product:content:replaced"===e.type,n=document.querySelector("#product-glide"),i=document.querySelector("#product-thumbs");if(n){var d;if(t||window._productMediaHasInit?d=parseInt(n.getAttribute("data-start-index"))||0:(d=0,window._productMediaHasInit=!0),n._glideInstance){try{n._glideInstance.destroy()}catch(e){}n._glideInstance=null}if(i&&i._glideInstance){try{i._glideInstance.destroy()}catch(e){}i._glideInstance=null}if(window.Glide)a();else{var c="https://cdn.jsdelivr.net/npm/@glidejs/glide";if(document.querySelector('script[src="'+c+'"]')){var r=setInterval(function(){window.Glide&&(clearInterval(r),a())},100);setTimeout(function(){clearInterval(r)},5e3)}else{var l=document.createElement("script");l.src=c,l.onload=a,l.onerror=function(){console.warn("product-media: failed to load Glide")},document.head.appendChild(l)}}}function a(){try{var e=new Glide("#product-glide",{type:"carousel",perView:1,gap:16,startAt:d}).mount();if(n._glideInstance=e,i){var t=Math.min(5,i.querySelectorAll(".glide__slides > li").length||5),c=new Glide("#product-thumbs",{type:"slider",perView:t,gap:8}).mount();function r(e){i.querySelectorAll(".glide__slides > li").forEach(function(t,n){n===e?t.classList.add("thumb-active"):t.classList.remove("thumb-active")})}i._glideInstance=c,i.querySelectorAll(".thumb-btn").forEach(function(t){t.addEventListener("click",function(n){var i=parseInt(t.getAttribute("data-thumb-index"))||0;try{e.go("="+i)}catch(e){}})}),r(d||0),c.on("run.after",function(){try{e.go("="+c.index),r(c.index)}catch(e){}}),e.on("run.after",function(){try{var n=e.index,d=i.querySelectorAll(".glide__slides > li").length||0,l="number"==typeof c.index?c.index:0,a=t||1,o=l+a-1;if(n<l)c.go("="+n);else if(n>o){var s=Math.min(Math.max(n-a+1,0),Math.max(d-a,0));c.go("="+s)}r(n)}catch(e){}})}n.querySelectorAll(".glide__slide img").forEach(function(e){e.style.cursor="zoom-in"}),n.querySelectorAll(".glide__slide img, .slide-zoom-btn").forEach(function(t){t.addEventListener("click",function(t){var n=parseInt(t.currentTarget.getAttribute("data-slide-index")||e.index)||0,i=document.getElementById("product-lightbox"),d=document.getElementById("product-lightbox-glide");if(i&&d)if(i.classList.remove("hidden"),i.classList.add("flex"),d._glideInstance)try{d._glideInstance.go("="+n)}catch(t){}else try{d._glideInstance=new Glide("#product-lightbox-glide",{type:"carousel",perView:1,gap:16,startAt:n}).mount(),d._glideInstance.on("run.after",function(){try{e.go("="+d._glideInstance.index)}catch(e){}}),[i.querySelector(".product-gallery-arrow--left"),i.querySelector(".product-gallery-arrow--right")].forEach(function(e){e&&e.addEventListener("click",function(){var t=e.getAttribute("data-glide-dir");try{d._glideInstance.go(t)}catch(e){}})})}catch(t){console.warn("product-media: lightbox glide mount failed",t)}})}),n.querySelectorAll(".product-gallery-arrow").forEach(function(t){t.addEventListener("click",function(n){var i=t.getAttribute("data-glide-dir");if(i)try{i.indexOf("="),e.go(i)}catch(e){}})});var l=document.getElementById("product-lightbox-close"),a=document.getElementById("product-lightbox"),o=document.getElementById("product-lightbox-glide");l&&a&&l.addEventListener("click",function(){a.classList.add("hidden"),a.classList.remove("flex");try{o&&o._glideInstance&&(o._glideInstance.destroy(),o._glideInstance=null)}catch(e){}}),a&&a.addEventListener("click",function(e){if(e.target===a){a.classList.add("hidden"),a.classList.remove("flex");try{o&&o._glideInstance&&(o._glideInstance.destroy(),o._glideInstance=null)}catch(e){}}})}catch(s){console.error("product-media: Glide init failed",s)}}}document.addEventListener("DOMContentLoaded",e),document.addEventListener("product:content:replaced",e)}();