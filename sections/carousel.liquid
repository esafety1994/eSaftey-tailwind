<style>
  .glide__bullet--active {
    background-color: transparent;
    border: 1px solid;
    height: calc(var(--spacing) * 3);
    width: calc(var(--spacing) * 3);
  }
</style>
<div class="glide relative">
  <div class="glide__track" data-glide-el="track">
    <ul class="glide__slides">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'slider_item' %}
            <li class="glide__slide relative w-full">
              <div
                class="h-[20vh] lg:h-[55vh] w-full bg-cover bg-center"
                style="background-image: url('{{ block.settings.background | image_url: width: 1920 }}');"
              >
                {% if block.settings.single_image %}
                  <a href="{{ block.settings.button_link }}" class="w-full h-full block"> </a>
                {% else %}
                  <div class="w-full h-full flex carousel-content--{{ block.settings.content_position }}">
                    <div class="container m-auto">
                      <div class="max-w-lg {% if block.settings.content_position == 'right' %} ml-auto {% endif %}">
                        {% if block.settings.title != blank %}
                          <h3 class="text-2xl mb-4">{{ block.settings.title }}</h3>
                        {% endif %}

                        {% if block.settings.description != blank %}
                          <h2 class="text-xl mb-6 font-semibold">{{ block.settings.description }}</h2>
                        {% endif %}

                        {% if block.settings.button_text != blank and block.settings.button_link != blank %}
                          <a href="{{ block.settings.button_link }}" class="btn primary-button">
                            {{ block.settings.button_text }}
                          </a>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                {% endif %}
              </div>
            </li>
        {% endcase %}
      {% endfor %}
    </ul>
  </div>

  {% assign block_count = section.blocks | size %}
  {% if block_count > 1 %}
    <div class="glide__arrows absolute top-1/2 w-full" data-glide-el="controls">
      <button
        class="glide__arrow glide__arrow--left absolute left-5 text-slate-800 cursor-pointer hover:text-slate-900 hover:scale-105 transition-all"
        data-glide-dir="<"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="size-12"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
        </svg>
      </button>
      <button
        class="glide__arrow glide__arrow--right absolute right-5 text-slate-800 cursor-pointer hover:text-slate-900 hover:scale-105 transition-all"
        data-glide-dir=">"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="size-12"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
        </svg>
      </button>
    </div>

    <div
      class="glide__bullets absolute bottom-0 flex justify-center items-center gap-2 w-full h-10"
      data-glide-el="controls[nav]"
    >
      {% assign loop_limit = block_count | minus: 1 %}
      {% for i in (0..loop_limit) %}
        <button
          class="glide__bullet bg-black w-2.5 h-2.5 rounded-full cursor-pointer transition-all hover:bg-transparent hover:border"
          data-glide-dir="={{ i }}"
        ></button>
      {% endfor %}
    </div>
  {% endif %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    function initGlide(el) {
      new Glide(el, {
        autoplay: false,
        hoverpause: true,
      }).mount();
    }

    var glideEls = document.querySelectorAll('.glide');
    if (!glideEls.length) return;

    // If Glide already loaded, just init each instance
    if (window.Glide) {
      glideEls.forEach(initGlide);
      return;
    }

    // Otherwise load CSS (if not present) and script once, then init
    if (!document.querySelector('link[href*="glide.core.min.css"]')) {
      var l = document.createElement('link');
      l.rel = 'stylesheet';
      l.href = "{{ 'glide.core.min.css' | asset_url }}";
      document.head.appendChild(l);
    }

    var s = document.createElement('script');
    s.src = "{{ 'glide.min.js' | asset_url }}";
    s.defer = true;
    s.onload = function () {
      glideEls.forEach(initGlide);
    };
    document.head.appendChild(s);
  });
</script>
{% schema %}
{
  "name": "Carousel",
  "settings": [],
  "blocks": [
    {
      "type": "slider_item",
      "name": "Image slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "background",
          "label": "Image on desktop",
          "info": "1920 x 900px recommended"
        },
        {
          "type": "checkbox",
          "id": "single_image",
          "label": "Is Single Image",
          "default": false
        },
        {
          "type": "header",
          "content": "Carousel Content"
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "Content position",
          "default": "left",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            }
          ]
        },

        {
          "type": "textarea",
          "id": "title",
          "label": "Heading",
          "default": "New Collection",
          "info": "Allows custom HTML"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description",
          "default": "<p>Tell your campaign through images</p>"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button label",
          "default": "Shop now"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Carousel"
    }
  ]
}
{% endschema %}
