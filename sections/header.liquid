<section class="top-bar hidden container mx-auto px-4 max-w-7xl md:flex py-4 transition-all duration-500">
  {% render 'top-navbar' %}
</section>
<header id="site-header" class="site-header transition-all duration-300">
  <div class=" bg-black p-2 ">
    <div class="wrapper container flex items-center justify-between m-auto">
      {% render 'header' %}
    </div>
  </div>
  {% if template == 'product' or template == 'collection' %}
    {% render 'header-upsell-section' %}
  {% endif %}
</header>

<!-- spacer to prevent layout jump when header becomes fixed -->
<div id="header-spacer" aria-hidden="true" style="display:none"></div>

<script>
  (function () {
    var header = document.getElementById('site-header');
    var spacer = document.getElementById('header-spacer');
    if (!header || !spacer) return;

    function updateSticky() {
      var fold = 250;
      var shouldBeSticky = window.scrollY > fold;

      if (shouldBeSticky && !header.classList.contains('is-sticky')) {
        // set spacer height to preserve layout
        spacer.style.display = 'block';
        spacer.style.height = header.offsetHeight + 'px';

        header.classList.add('is-sticky');
        header.classList.add('fixed', 'top-0', 'left-0', 'right-0', 'z-50', 'shadow-md');
        header.setAttribute('aria-hidden', 'false');
      } else if (!shouldBeSticky && header.classList.contains('is-sticky')) {
        spacer.style.display = 'none';
        spacer.style.height = '';

        header.classList.remove('is-sticky');
        header.classList.remove('fixed', 'top-0', 'left-0', 'right-0', 'z-50', 'shadow-md');
      }
    }

    // run on load and scroll/resize
    document.addEventListener('DOMContentLoaded', updateSticky);
    window.addEventListener('load', updateSticky);
    window.addEventListener('scroll', updateSticky, { passive: true });
    window.addEventListener('resize', updateSticky);
  })();
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show Search Box",
      "default": true
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Select Menu",
      "default": "main-menu"
    }
  ],
  "blocks": [
    {
      "type": "mega_menu_item",
      "name": "Mega Menu Item Image",
      "settings": [
        {
          "type": "text",
          "id": "menu_item",
          "label": "Menu Item Title (must match parent menu link)"
        },
        {
          "type": "image_picker",
          "id": "menu_item_image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "menu_item_link",
          "label": "Image Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Header"
    }
  ]
}
{% endschema %}
