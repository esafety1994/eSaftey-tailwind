{% comment %} Connect / Follow section - two column layout above footer {% endcomment %}
<div id="connect-stay-{{ section.id }}" class="bg-grey border-t border-gray-100 py-10">
  <div class="max-w-7xl my-6 mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
      <div class="follow-us text-center">
        <h3 class="text-3xl mb-3">{{ section.settings.follow_title }}</h3>
        <p class=" mb-4">{{ section.settings.follow_text }}</p>
        <div class="flex flex-wrap gap-4 items-center justify-center py-4">
          {%- if section.settings.use_theme_social -%}
            {%- assign sl = shop.brand.metafields.social_links -%}
            {%- if sl != blank -%}
              {% comment %} facebook {% endcomment %}
              {% assign fb_url = sl.facebook.value | default: sl.facebook %}
              {% if fb_url != blank %}
                <a href="{{ fb_url }}" class="inline-flex items-center gap-2" target="_blank" rel="noopener noreferrer">
                  <span class="sr-only">Facebook</span>
                  <svg class="w-8 h-8" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.75 8C15.75 9.91667 15.125 11.6042 13.875 13.0625C12.625 14.5 11.0729 15.3646 9.21875 15.6562V10.25H11.0312L11.375 8H9.21875V6.53125C9.21875 5.73958 9.63542 5.34375 10.4688 5.34375H11.4375V3.4375C10.8542 3.33333 10.2812 3.28125 9.71875 3.28125C9.11458 3.28125 8.59375 3.39583 8.15625 3.625C7.73958 3.85417 7.40625 4.19792 7.15625 4.65625C6.90625 5.11458 6.78125 5.65625 6.78125 6.28125V8H4.8125V10.25H6.78125V15.6562C4.92708 15.3646 3.375 14.5 2.125 13.0625C0.875 11.6042 0.25 9.91667 0.25 8C0.25 5.85417 1 4.03125 2.5 2.53125C4.02083 1.01042 5.85417 0.25 8 0.25C10.1458 0.25 11.9688 1.01042 13.4688 2.53125C14.9896 4.03125 15.75 5.85417 15.75 8Z" fill="currentColor"></path>
                  </svg>
                </a>
              {% endif %}

              {% comment %} instagram {% endcomment %}
              {% assign ig_url = sl.instagram.value | default: sl.instagram %}
              {% if ig_url != blank %}
                <a href="{{ ig_url }}" class="inline-flex items-center gap-2" target="_blank" rel="noopener noreferrer">
                  <span class="sr-only">Instagram</span>
                  <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                    <path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path>
                  </svg>
                </a>
              {% endif %}

              {% comment %} linkedin {% endcomment %}
              {% assign li_url = sl.linkedin.value | default: sl.linkedin %}
              {% if li_url != blank %}
                <a href="{{ li_url }}" class="inline-flex items-center gap-2" target="_blank" rel="noopener noreferrer">
                  <span class="sr-only">LinkedIn</span>
                  <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                    <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path>
                  </svg>
                </a>
              {% endif %}
              {% comment %} youtube {% endcomment %}
              {% assign yt_url = sl.youtube.value | default: sl.youtube %}
              {% if yt_url != blank %}
                <a href="{{ yt_url }}" class="inline-flex items-center gap-2" target="_blank" rel="noopener noreferrer">
                  <span class="sr-only">YouTube</span>
                  <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                    <path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path>
                  </svg>
                </a>
              {% endif %}
              {% comment %} tiktok {% endcomment %}
              {% assign tt_url = sl.tiktok.value | default: sl.tiktok %}
              {% if tt_url != blank %}
                <a href="{{ tt_url }}" class="inline-flex items-center gap-2" target="_blank" rel="noopener noreferrer">
                  <span class="sr-only">TikTok</span>
                  <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                    <path fill="currentColor" d="M448 209.91a210.06 210.06 0 01-122.77-39.25v178.72A162.55 162.55 0 11185 188.31v89.89a74.62 74.62 0 1052.23 71.18V0h88a121.18 121.18 0 001.86 22.17A122.18 122.18 0 00381 102.39a121.43 121.43 0 0067 20.14z"></path>
                  </svg>
                </a>
              {% endif %}
            {%- endif -%}
          {%- endif -%}

          {%- comment -%} Manual social blocks (fallback or override) {%- endcomment -%}
          {%- for block in section.blocks -%}
            {% if block.type == 'social' and block.settings.url != blank %}
              <a
                href="{{ block.settings.url }}"
                class="inline-flex items-center gap-2"
                target="_blank"
                rel="noopener noreferrer"
              >
                <span class="sr-only">{{ block.settings.label }}</span>
                {% case block.settings.icon %}
                  {% when 'instagram' %}
                    <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                      <path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path>
                    </svg>
                  {% when 'facebook' %}
                    <svg class="w-8 h-8" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M15.75 8C15.75 9.91667 15.125 11.6042 13.875 13.0625C12.625 14.5 11.0729 15.3646 9.21875 15.6562V10.25H11.0312L11.375 8H9.21875V6.53125C9.21875 5.73958 9.63542 5.34375 10.4688 5.34375H11.4375V3.4375C10.8542 3.33333 10.2812 3.28125 9.71875 3.28125C9.11458 3.28125 8.59375 3.39583 8.15625 3.625C7.73958 3.85417 7.40625 4.19792 7.15625 4.65625C6.90625 5.11458 6.78125 5.65625 6.78125 6.28125V8H4.8125V10.25H6.78125V15.6562C4.92708 15.3646 3.375 14.5 2.125 13.0625C0.875 11.6042 0.25 9.91667 0.25 8C0.25 5.85417 1 4.03125 2.5 2.53125C4.02083 1.01042 5.85417 0.25 8 0.25C10.1458 0.25 11.9688 1.01042 13.4688 2.53125C14.9896 4.03125 15.75 5.85417 15.75 8Z" fill="currentColor"></path>
                    </svg>
                  {% when 'twitter' %}
                    <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path d="M22 5.924c-.63.28-1.3.47-2 .55a3.48 3.48 0 001.53-1.92 6.95 6.95 0 01-2.2.84 3.47 3.47 0 00-5.92 3.16A9.85 9.85 0 013 4.89a3.47 3.47 0 001.07 4.63 3.44 3.44 0 01-1.57-.43v.04a3.47 3.47 0 002.78 3.4 3.5 3.5 0 01-1.56.06 3.48 3.48 0 003.24 2.41A6.97 6.97 0 012 19.54a9.83 9.83 0 005.32 1.56c6.38 0 9.87-5.28 9.87-9.86v-.45A7.06 7.06 0 0022 5.924z"/>
                    </svg>
                  {% when 'linkedin' %}
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                      <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path>
                    </svg>
                  {% else %}
                    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="12" cy="12" r="10"/>
                    </svg>
                {% endcase %}
              </a>
            {% endif %}
          {%- endfor -%}
        </div>
      </div>

      <div class="stay-in-touch text-center">
        <h3 class="text-3xl mb-3">{{ section.settings.subscribe_title }}</h3>
        <p class="mb-4 ">{{ section.settings.subscribe_text }}</p>

        <form id="connect-newsletter-{{ section.id }}" class="flex gap-2" method="post" action="/contact">
          <input type="hidden" name="form_type" value="contact">
          <input type="hidden" name="contact[tags]" value="newsletter">
          <label for="connect-email-{{ section.id }}" class="sr-only">Email</label>
          <input
            id="connect-email-{{ section.id }}"
            name="contact[email]"
            type="email"
            required
            placeholder="{{ section.settings.email_placeholder }}"
            class="w-full md:w-auto flex-1 px-3 py-2 bg-white rounded-md focus:outline-none focus:ring-2 focus:ring-primary-light"
          >
          <button
            type="submit"
            class="inline-flex items-center px-4 py-2 bg-bg-light-red text-white rounded-md hover:bg-primary hover:text-black transition-all duration-200 ease-in-out cursor-pointer"
          >
            {{ section.settings.subscribe_button_label }}
          </button>
        </form>

        <p id="connect-newsletter-msg-{{ section.id }}" class="mt-2 text-sm text-green-600 hidden"></p>
      </div>
    </div>
  </div>

  <script>
    (function () {
      var form = document.getElementById('connect-newsletter-{{ section.id }}');
      var msg = document.getElementById('connect-newsletter-msg-{{ section.id }}');
      if (!form) return;
      form.addEventListener('submit', function (e) {
        e.preventDefault();
        var data = new FormData(form);
        fetch(form.action, { method: 'POST', body: data, credentials: 'same-origin' })
          .then(function (res) {
            if (res.ok) return res.text();
            throw new Error('Network response was not ok');
          })
          .then(function () {
            msg.textContent = '{{ section.settings.success_message | escape }}';
            msg.classList.remove('hidden');
            form.reset();
          })
          .catch(function () {
            msg.textContent = '{{ section.settings.error_message | escape }}';
            msg.classList.remove('hidden');
          });
      });
    })();
  </script>
</div>

{% schema %}
{
  "name": "Connect / Stay in touch",
  "settings": [
    { "type": "text", "id": "follow_title", "label": "Follow title", "default": "Follow us" },
    {
      "type": "textarea",
      "id": "follow_text",
      "label": "Description",
      "default": "Stay up to date on promotions, giveaways, BTS and free resources"
    },
    {
      "type": "checkbox",
      "id": "use_theme_social",
      "label": "Use social links from brand settings (shop.social_accounts)",
      "default": true
    },
    { "type": "text", "id": "subscribe_title", "label": "Subscribe title", "default": "Let's stay in touch" },
    {
      "type": "textarea",
      "id": "subscribe_text",
      "label": "Subscribe subtext",
      "default": "Sign up for news and exclusive offers."
    },
    { "type": "text", "id": "email_placeholder", "label": "Email placeholder", "default": "Your email address" },
    { "type": "text", "id": "subscribe_button_label", "label": "Subscribe button label", "default": "Subscribe" },
    { "type": "text", "id": "success_message", "label": "Success message", "default": "Thanks â€” we'll be in touch." },
    {
      "type": "text",
      "id": "error_message",
      "label": "Error message",
      "default": "Sorry, something went wrong. Please try again."
    }
  ],
  "blocks": [
    {
      "type": "social",
      "name": "Social link",
      "settings": [
        { "type": "text", "id": "label", "label": "Label", "default": "Social" },
        { "type": "url", "id": "url", "label": "URL" },
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "options": [
            { "value": "facebook", "label": "Facebook" },
            { "value": "instagram", "label": "Instagram" },
            { "value": "twitter", "label": "Twitter" },
            { "value": "linkedin", "label": "LinkedIn" },
            { "value": "youtube", "label": "YouTube" }
          ]
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [{ "name": "Connect / Stay in touch", "category": "Footer" }]
}
{% endschema %}
